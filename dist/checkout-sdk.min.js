!function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};window.vtex||(window.vtex={}),(b=window.vtex).checkout||(b.checkout={}),a=function(){function a(){this._getProfileURL=c(this._getProfileURL,this),this._getPostalCodeURL=c(this._getPostalCodeURL,this),this._getUpdateItemURL=c(this._getUpdateItemURL,this),this._startTransactionURL=c(this._startTransactionURL,this),this._getOrdersURL=c(this._getOrdersURL,this),this._getAddCouponURL=c(this._getAddCouponURL,this),this._getRemoveOfferingsURL=c(this._getRemoveOfferingsURL,this),this._getAddOfferingsURL=c(this._getAddOfferingsURL,this),this._getSaveAttachmentURL=c(this._getSaveAttachmentURL,this),this._getOrderFormURL=c(this._getOrderFormURL,this),this._getOrderFormIdFromURL=c(this._getOrderFormIdFromURL,this),this._getOrderFormIdFromCookie=c(this._getOrderFormIdFromCookie,this),this._getOrderFormId=c(this._getOrderFormId,this),this.getOrders=c(this.getOrders,this),this.startTransaction=c(this.startTransaction,this),this.getProfileByEmail=c(this.getProfileByEmail,this),this.getAddressInformation=c(this.getAddressInformation,this),this.calculateShipping=c(this.calculateShipping,this),this.removeDiscountCoupon=c(this.removeDiscountCoupon,this),this.addDiscountCoupon=c(this.addDiscountCoupon,this),this.removeItems=c(this.removeItems,this),this.updateItems=c(this.updateItems,this),this.removeOffering=c(this.removeOffering,this),this.addOffering=c(this.addOffering,this),this.sendLocale=c(this.sendLocale,this),this.sendAttachment=c(this.sendAttachment,this),this.getOrderForm=c(this.getOrderForm,this),this.CHECKOUT_ID="checkout",this.HOST_URL=$.url().attr("base"),this.HOST_ORDER_FORM_URL=this.HOST_URL+"/api/checkout/pub/orderForm/",this.HOST_CART_URL=this.HOST_URL+"/"+$.url().segment(-2)+"/cart/",this.COOKIE_NAME="checkout.vtex.com",this.COOKIE_ORDER_FORM_ID_KEY="__ofid",this.POSTALCODE_URL=this.HOST_URL+"/api/checkout/pub/postal-code/",this.GATEWAY_CALLBACK_URL=this.HOST_URL+"/checkout/gatewayCallback/{0}/{1}/{2}",this.requestingItem=void 0,this.stateRequestHashToResponseMap={},this.subjectToJqXHRMap={}}return a.prototype.expectedFormSections=function(){return["items","gifts","totalizers","clientProfileData","shippingData","paymentData","sellers","messages","marketingData","clientPreferencesData","storePreferencesData"]},a.prototype.getOrderForm=function(a){var b;return null==a&&(a=this.expectedFormSections()),b={expectedOrderFormSections:a},$.ajaxQueue({url:this._getOrderFormURL(),type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(b)})},a.prototype.sendAttachment=function(a,b,c,d){var e,f,g,h,i,j,k,l=this;if(null==c&&(c=this.expectedFormSections()),null==d&&(d={}),g={expectedOrderFormSections:c},void 0===a||void 0===b)return vtex.logger.error("SendAttachment with undefined properties! attachmentId: "+a+"; serializedAttachment: "+b),e=$.Deferred(),e.reject("Invalid arguments"),e.promise();if(_.extend(g,JSON.parse(b)),d.cache&&d.currentStateHash){if(h=_.hash(a+JSON.stringify(g)),i=d.currentStateHash.toString()+":"+h.toString(),this.stateRequestHashToResponseMap[i])return vtex.logger.localdebug(["CACHE HIT:",a,i,this.stateRequestHashToResponseMap[i]].join(" ")),f=$.Deferred(),f.resolve(this.stateRequestHashToResponseMap[i]),f.promise();vtex.logger.localdebug(["CACHE MISS:",a,i].join(" "))}return j=$.ajaxQueue({url:this._getSaveAttachmentURL(a),type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(g)}),d.abort&&d.subject&&(null!=(k=this.subjectToJqXHRMap[d.subject])&&k.abort(),this.subjectToJqXHRMap[d.subject]=j),d.cache&&d.currentStateHash&&j.done(function(a){return l.stateRequestHashToResponseMap[i]=a}),j},a.prototype.sendLocale=function(a){var b,c;return null==a&&(a="pt-BR"),b="clientPreferencesData",c=JSON.stringify({locale:a}),this.sendAttachment(b,c,[])},a.prototype.addOffering=function(a,b,c){var d;return d={Id:a,expectedOrderFormSections:null!=c?c:this.expectedFormSections()},$.ajaxQueue({url:this._getAddOfferingsURL(b),type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(d)})},a.prototype.removeOffering=function(a,b,c){var d;return d={Id:a,expectedOrderFormSections:null!=c?c:this.expectedFormSections()},$.ajaxQueue({url:this._getRemoveOfferingsURL(b,a),type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(d)})},a.prototype.updateItems=function(a,b){var c,d=this;return null==b&&(b=this.expectedFormSections()),c={orderItems:a,expectedOrderFormSections:b},void 0!==this.requestingItem&&(this.requestingItem.abort(),console.log("Abortando",this.requestingItem)),this.requestingItem=$.ajaxQueue({url:this._getUpdateItemURL(),type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(c)}).done(function(){return d.requestingItem=void 0})},a.prototype.removeItems=function(a){var b,c,d=this;return b=$.Deferred(),c=a?$.when(a):this.getOrderForm(["items"]).then(function(a){return a.items}),c.then(function(a){return d.updateItems(_(a).map(function(a){return{index:a.index,quantity:0}}).reverse()).done(function(a){return b.resolve(a)}).fail(b.reject)}),b.promise()},a.prototype.addDiscountCoupon=function(a,b){var c;return c={text:a,expectedOrderFormSections:null!=b?b:this.expectedFormSections()},$.ajaxQueue({url:this._getAddCouponURL(),type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(c)})},a.prototype.removeDiscountCoupon=function(a){return this.addDiscountCoupon("",a)},a.prototype.calculateShipping=function(a){var b;return b={address:a},this.sendAttachment("shippingData",JSON.stringify(b))},a.prototype.getAddressInformation=function(a){return $.ajax({url:this._getPostalCodeURL(a.postalCode,a.country),type:"GET",timeout:2e4})},a.prototype.getProfileByEmail=function(a,b){return $.ajax({url:this._getProfileURL(),type:"GET",data:{email:a,sc:b}})},a.prototype.startTransaction=function(a,b,c,d,e,f){var g;return null==d&&(d=!1),null==e&&(e=!1),null==f&&(f=this.expectedFormSections()),g={referenceId:this._getOrderFormId(),savePersonalData:d,optinNewsLetter:e,value:a,referenceValue:b,interestValue:c,expectedOrderFormSections:f},$.ajaxQueue({url:this._startTransactionURL(),type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(g)})},a.prototype.getOrders=function(a){return $.ajaxQueue({url:this._getOrdersURL(a),type:"GET",contentType:"application/json; charset=utf-8",dataType:"json"})},a.prototype.clearMessages=function(){var a;return a={expectedOrderFormSections:[]},$.ajaxQueue({url:this._getOrderFormURL()+"/messages/clear",type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(a)})},a.prototype.removeAccountId=function(a){var b;return b={expectedOrderFormSections:[]},$.ajaxQueue({url:this._getOrderFormURL()+"/paymentAccount/"+a+"/remove",type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(b)})},a.prototype.getChangeToAnonymousUserURL=function(){return this.HOST_URL+"/checkout/changeToAnonymousUser/"+this._getOrderFormId()},a.prototype._getOrderFormId=function(){return this._getOrderFormIdFromCookie()||this._getOrderFormIdFromURL()||""},a.prototype._getOrderFormIdFromCookie=function(){var a;return a=_.readCookie(this.COOKIE_NAME),void 0!==a&&""!==a?_.getCookieValue(a,this.COOKIE_ORDER_FORM_ID_KEY):void 0},a.prototype._getOrderFormIdFromURL=function(){return $.url().param("orderFormId")},a.prototype._getOrderFormURL=function(){return this.HOST_ORDER_FORM_URL+this._getOrderFormId()},a.prototype._getSaveAttachmentURL=function(a){return this._getOrderFormURL()+"/attachments/"+a},a.prototype._getAddOfferingsURL=function(a){return this._getOrderFormURL()+"/items/"+a+"/offerings"},a.prototype._getRemoveOfferingsURL=function(a,b){return this._getOrderFormURL()+"/items/"+a+"/offerings/"+b+"/remove"},a.prototype._getAddCouponURL=function(){return this._getOrderFormURL()+"/coupons"},a.prototype._getOrdersURL=function(a){return this.HOST_URL+"/api/checkout/pub/orders/order-group/"+a},a.prototype._startTransactionURL=function(){return this._getOrderFormURL()+"/transaction"},a.prototype._getUpdateItemURL=function(){return this._getOrderFormURL()+"/items/update/"},a.prototype._getPostalCodeURL=function(a,b){return null==a&&(a=""),null==b&&(b="BRA"),this.POSTALCODE_URL+b+"/"+a},a.prototype._getProfileURL=function(){return this.HOST_URL+"/api/checkout/pub/profiles/"},a}(),window.vtex.checkout.API=a,window.vtex.checkout.API.version="0.1.0",window.vtex.checkout.SDK=a,window.vtex.checkout.SDK.version="0.1.0"}.call(this);